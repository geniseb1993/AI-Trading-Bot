# AutoTrader Module

The AutoTrader module provides automated trading capabilities for the AI Trading Bot. It allows the system to automatically execute trades based on signals generated by various sources such as the trading bot's AI signals, external webhooks, or manual entries.

## Components

The automated trading module consists of these key components:

1. **AutoTrader Class** (`auto_trade.py`): Core implementation that processes signals and executes trades
2. **API Routes** (`auto_trade_routes.py`): RESTful endpoints to control the auto trader
3. **Trade Executor** (`trade_executor.py`): Handles the actual order execution through broker integrations

## How It Works

The AutoTrader works by:

1. Running a background thread that monitors for signals
2. Processing incoming trade signals from the queue
3. Validating signals against risk management rules
4. Calculating appropriate position sizes
5. Executing trades with stop-loss and take-profit orders

## Configuration Options

The AutoTrader can be configured through a JSON configuration file or API. Key options include:

| Option | Description | Default |
|--------|-------------|---------|
| `enabled` | Master switch to enable/disable auto trading | `false` |
| `risk_per_trade` | Percentage of account to risk per trade | `0.01` (1%) |
| `max_open_trades` | Maximum number of concurrent open positions | `5` |
| `max_position_size` | Maximum percentage of account in one position | `0.20` (20%) |
| `ignored_symbols` | List of symbols to ignore | `[]` |

## Signal Format

A valid trade signal must include the following fields:

```json
{
  "symbol": "AAPL",        // Trading symbol (required)
  "position_type": "LONG", // LONG or SHORT (required)
  "entry_price": 180.50,   // Target entry price (required)
  "stop_loss": 177.25,     // Stop loss price (strongly recommended)
  "take_profit": 186.75,   // Take profit price (optional)
  "quantity": 10,          // Number of shares (optional, calculated if omitted)
  "signal_score": 8.5,     // Signal confidence score 0-10 (optional)
  "use_market": false      // Whether to use market order instead of limit (optional)
}
```

## API Endpoints

The auto trader provides these RESTful API endpoints:

### GET `/api/auto-trade/status`
Get current status of the auto trader system.

### POST `/api/auto-trade/start`
Start the auto trader monitoring system.

### POST `/api/auto-trade/stop`
Stop the auto trader monitoring system.

### GET `/api/auto-trade/config`
Get current auto trader configuration.

### PUT `/api/auto-trade/config`
Update auto trader configuration.
```json
{
  "enabled": true,
  "risk_per_trade": 0.02,
  "max_open_trades": 8
}
```

### POST `/api/auto-trade/enable`
Enable auto trading (shortcut for updating config).

### POST `/api/auto-trade/disable`
Disable auto trading (shortcut for updating config).

### POST `/api/auto-trade/signal`
Submit a trading signal for processing.
```json
{
  "symbol": "MSFT",
  "position_type": "LONG",
  "entry_price": 380.25,
  "stop_loss": 375.50,
  "take_profit": 390.00
}
```

### GET `/api/auto-trade/history`
Get auto trader trade history. Optional `limit` query parameter to control number of results.

### GET `/api/auto-trade/queue`
Get current signal queue size.

## Usage Examples

### Enable Auto Trading

```bash
curl -X POST http://localhost:5000/api/auto-trade/enable
```

### Submit a Trade Signal

```bash
curl -X POST http://localhost:5000/api/auto-trade/signal \
  -H "Content-Type: application/json" \
  -d '{
    "symbol": "AAPL",
    "position_type": "LONG",
    "entry_price": 180.50,
    "stop_loss": 177.25,
    "take_profit": 186.75
  }'
```

### Update Configuration

```bash
curl -X PUT http://localhost:5000/api/auto-trade/config \
  -H "Content-Type: application/json" \
  -d '{
    "risk_per_trade": 0.015,
    "max_open_trades": 7,
    "ignored_symbols": ["GME", "AMC"]
  }'
```

## Integration with Signal Sources

The auto trader can process signals from:

1. **AI Signal Ranking System**: Connect the AI signals directly to the auto trader
2. **TradingView Webhooks**: Process alerts from TradingView as trade signals
3. **Manual UI Entries**: Allow traders to submit signals through the web interface
4. **External Systems**: Any external system that can call the signal API

## Risk Management

The auto trader incorporates several risk management features:

1. **Per-trade risk limiting**: Never risk more than the configured percentage per trade
2. **Maximum position size**: Limits exposure to any single asset
3. **Maximum open trades**: Prevents overexposure to the market
4. **Mandatory stop-loss**: Every trade requires a stop-loss for risk management
5. **Optional take-profit**: Can automatically exit profitable positions 